{# USED TO DISPLAY IMAGES IN DATABASE #}

{% extends "parent_template.html" %}

{% block CSS %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/>
    <link href="../static/css/lc_lightbox.min.css" rel="stylesheet"/>
    <link href="../static/css/dark.css" rel="stylesheet"/>
    <link href="../static/css/image_style.css" rel="stylesheet"/>
{% endblock %}

{% block app_content %}

    <header class="bg-info text-center py-3 mb-4">
        <div class="container">
            <h1 class="font-weight-light text-white">Image Gallery</h1>
        </div>
    </header>


    <div class="row ml-1">
        {% for image in images %}
            <div class="col-md-3 my-5">
                <div class="img-wrapper">
                    <img class="img-responsive"
                         src="{{ url_for('static', filename=image.image_url) }}" alt="Responsive image">

                    <div class="img-overlay" id="like">
                        <a href="{{ url_for('like_action', image_id=image.id, action="like") }}"
                           role="button">
                            {% if current_user.is_anonymous or not current_user.has_liked_image(image) %}
                                {# Bootstrap icon for caret-up no fill #}
                                <svg class="bi bi-caret-up text-success" width="1em" height="1em" viewBox="0 0 16 16"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                          d="M3.204 11L8 5.519 12.796 11H3.204zm-.753-.659l4.796-5.48a1 1 0 011.506 0l4.796 5.48c.566.647.106 1.659-.753 1.659H3.204a1 1 0 01-.753-1.659z"
                                          clip-rule="evenodd"></path>
                                </svg>
                            {% else %}
                                {# Bootstrap icon for caret-up fill #}
                                <svg class="bi bi-caret-up-fill text-success" width="1em" height="1em" viewBox="0 0 16 16"
                                     fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 00.753-1.659l-4.796-5.48a1 1 0 00-1.506 0z"></path>
                                </svg>
                            {% endif %}
                        </a>
                    </div>

                    <div class="img-overlay" id="dislike">
                        {# Bootstrap icon for caret-up no fill #}
                        <a href="{{ url_for('like_action', image_id=image.id, action="dislike") }}"
                           role="button">
                            {% if  current_user.is_anonymous or not current_user.has_disliked_image(image)%}
                                {# Bootstrap icon for caret-down no fill #}
                                <svg class="bi bi-caret-down text-danger" width="1em" height="1em" viewBox="0 0 16 16"
                                     fill="currentColor"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                          d="M3.204 5L8 10.481 12.796 5H3.204zm-.753.659l4.796 5.48a1 1 0 001.506 0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 00-.753 1.659z"
                                          clip-rule="evenodd"></path>
                                </svg>
                            {% else %}
                                {# Bootstrap icon for caret-down fill #}
                                <svg class="bi bi-caret-down-fill text-danger" width="1em" height="1em" viewBox="0 0 16 16"
                                     fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 01.753 1.659l-4.796 5.48a1 1 0 01-1.506 0z"></path>
                                </svg>
                            {% endif %}
                        </a>
                    </div>

                    <div class="img-overlay" id="text">
                        <p class="text-white">{{ image.likes.count() - image.dislikes.count() }}</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>


    </div>


    {#{% for column in range(numcol) %}
            {% if (row+column) < num_imgs %}
                {% if current_user.is_authenticated %}

                    {% with left_margin = 80 %}
                        {% if current_user.has_liked_image(images[row+column]) %}

                            <a href="{{ url_for('like_action', image_id=images[row+column].id, action="dislike") }}"
                               class="btn btn-info btn-xs" role="button"
                               style="position:absolute; left:{{ (250 * column) + (1 + column) * left_margin }}px">Dislike</a>
                        {% else %}

                            <a href="{{ url_for('like_action', image_id=images[row+column].id, action="like") }}"
                               class="btn btn-info btn-xs" role="button"
                               style="position:absolute; left:{{ (250 * column) + (1 + column) * left_margin }}px">Like</a>
                        {% endif %}
                    {% endwith %}
                {% endif %}


                #}{# left_margin = 247px; spacing = 99px #}{#
                <strong class="text-white" style="position: absolute; left:{{ (80 * column) + (1 + column) * 250 }}px">
                    {{ images[row+column].likes.count() }} Likes
                </strong>

            {% endif %}
        {% endfor %}
        <br>
        <br>
        <br>

    {% endfor %}

    #}{# hardcoded images where javascript/download works #}{#

    <div class="container mt-5 mb-5">
        <a class="mybox" href="../static/images/img-3.jpg" title="Title 1" data-lcl-txt="Description 1"
           data-lcl-author="Tedir Ghazali">
            <img src="../static/images/img-3.jpg" class="mb-2" width="200" alt="..">
        </a>

        <a class="mybox" href="../static/images/img-2.jpg" title="Title 1" data-lcl-txt="Description 1"
           data-lcl-author="Tedir Ghazali">
            <img src="../static/images/img-3.jpg" class="mb-2" width="200" alt="..">
        </a>

        <a class="mybox" href="../static/images/img-4.jpg" title="Title 1" data-lcl-txt="Description 1"
           data-lcl-author="Tedir Ghazali">
            <img src="../static/images/img-3.jpg" class="mb-2" width="200" alt="..">
        </a>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="../static/lib/alloy_finger.min.js"></script>
    <script src="../static/Javascript/lc_lightbox.lite.min.js"></script>

    <script>
        lc_lightbox('.mybox', {
            wrap_class: 'lcl_fade_oc',
            gallery: true,
            skin: 'dark',
            counter: true,
            fullscreen: true,
            download: true,
            socials: true,
            autoplay: true,
            ol_opacity: true,
            ol_color: '#333',
            border_w: 5,
            border_col: '#ddd',
            radius: 5
        })
    </script>#}
{% endblock %}
