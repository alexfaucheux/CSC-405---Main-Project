{# USED TO DISPLAY IMAGES IN DATABASE #}

{% extends "parent_template.html" %}


{% block app_content %}

    <div id="demo" class="carousel slide" data-ride="carousel">

        <!-- Indicators -->
        <ul class="carousel-indicators">
            <li data-target="#demo" data-slide-to="0" class="active"></li>
            <li data-target="#demo" data-slide-to="1"></li>
            <li data-target="#demo" data-slide-to="2"></li>
            <li data-target="#demo" data-slide-to="3"></li>
            <li data-target="#demo" data-slide-to="4"></li>
        </ul>

        {# The Slideshow #}
        <div class="carousel-inner">
            <div class="container">
                <h3 class="text-white text-center">Featured Images</h3>
                {# Iterates through images #}
                {# Future feature: Include a featured tag to distinguish pictures #}
                {% for image in images %}
                    {# First image is made active; All others are not #}
                    {% if loop.index == 1 %}
                        <div class="carousel-item active">
                    {% else %}
                        <div class="carousel-item">
                    {% endif %}
                <img src="{{ url_for('static', filename=image.image_url) }}" alt="{{ loop.index }}"
                     style="margin-left:60px; width:1000px; height:600px"
                     class="img-fluid shadow-small p-1 mb-2 bg-danger">
                <div class="carousel-caption">
                    <p>{{ image.image_name }}</p>
                </div>
                </div>
                {% endfor %}
                </div>
            </div>
            <!-- Left and right controls -->
            <a class="carousel-control-prev" data-slide="prev" href="#demo">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" data-slide="next" href="#demo">
                <span class="carousel-control-next-icon"></span>
            </a>
        </div>
    </div>

    <br>
    <h3 class="text-white text-center">Image Gallery</h3>
    <hr style="background-color: white">
    <br>

    {# Prints the entire image collection #}
    {# Feature to be added: pagination #}
    {# This for loop iterates every 4 images #}
    {% for row in range(0, num_imgs, 4) %}
        {# Prints images #}
        <div class="clearfix"> {# clearfix adds essentially a <br> (break) after the divider #}
            {# 4 columns of images #}
            {% for column in range(4) %}
                {% if (row+column) < num_imgs %}
                    <img src="{{ url_for('static', filename=images[row+column].image_url) }}" alt="Responsive image"
                         class="rounded float-left shadow-small p-1 mx-5 bg-white"
                         style="width:250px; height:152px">

                {% endif %}
            {% endfor %}
        </div>

        {#<div class="container" id="tourpackages-carousel">

        <div class="col-xs-18 col-sm-6 col-md-3">
          <div class="thumbnail">
            <img src="http://placehold.it/500x300" alt="">
              <div class="caption">
                <h4>Thumbnail label</h4>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere, soluta, eligendi doloribus sunt minus amet sit debitis repellat. Consectetur, culpa itaque odio similique suscipit</p>
                <p><a href="#" class="btn btn-info btn-xs" role="button">Button</a> <a href="#" class="btn btn-default btn-xs" role="button">Button</a></p>
            </div>
          </div>
        </div>
        </div>#}

        {# After images are printed #}
        {# Adds like and unlike buttons and like counter #}
        {# 4 columns of buttons/like counters #}
        {% for column in range(4) %}
            {% if (row+column) < num_imgs %}
                {# Like and Unlike Button #}
                {# Won't display buttons unless user is logged in. May change in the future #}
                {% if current_user.is_authenticated %}
                    {# Also spacing = 299px #}
                    {% with left_margin = 47 %}
                        {% if current_user.has_liked_image(images[row+column]) %}
                            {# Unike Button #}
                            <a href="{{ url_for('like_action', image_id=images[row+column].id, action="dislike") }}" class="btn btn-info btn-xs" role="button"
                               style="position:absolute; left:{{ (299 * column) + (1 + column) * left_margin }}px">Dislike</a>
                        {% else %}
                            {# Like Button #}
                            <a href="{{ url_for('like_action', image_id=images[row+column].id, action="like") }}" class="btn btn-info btn-xs" role="button"
                               style="position:absolute; left:{{ (299 * column) + (1 + column) * left_margin }}px">Like</a>
                        {% endif %}
                    {% endwith %}
                {% endif %}

                {# Like counter #}
                {# left_margin = 247px; spacing = 99px #}
                <strong class="text-white" style="position: absolute; left:{{ (99 * column) + (1 + column) * 247 }}px">
                    {{ images[row+column].likes.count() }} Likes
                </strong>

            {% endif %}
        {% endfor %}
        <br>
        <br>
        <br>

    {% endfor %}
{% endblock %}
